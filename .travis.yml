services:
- docker
before_install:
- echo $DOCKER_PASSWD | docker login -u karrot96 --password-stdin
- docker pull karrot96/todo-app
- docker build --tag karrot96/todo-app --cache-from karrot96/todo-app .
- docker push karrot96/todo-app
- docker build --target test --tag my-test-image --cache-from karrot96/todo-app .
script:
- docker run -e TRELLO_BOARD_ID -e TRELLO_API_TOKEN -e TRELLO_API_KEY  my-test-image
after_success: 
- "./travis/build_and_tag_production.sh"
deploy:
  provider: script
  script: "./travis/deploy_to_heroku.sh"
env:
  global:
  - secure: SoS6POJUKw8d2DCqPNgfLyKPP2HVTDjRhu/LPlSouUj63Wk70XkZT64ZX5BnjNM/C+fO+zj1pQ2TGhiZU7CkIUhlfWiFYB5/VHGck6lzGvrUtQokWg5UuFb9giPZjRMaGStFoPopcV5f0QtISgVLedt81B6fSJoXQbRnk8wOAE8Sg+LeZgEzJfuHAr39/UIO7k+HcHPE5gJL3oclNUJ9sEFDSSH8TUx/UJJ3ysdhDzr51twfeRAf+Km4B/zlHA8vQ1BNLlgUfDKkBd2jiSDdPAivuVmC5AZCsp2mWFp/17g3J3Czve//89uhLY7Kia0G3NYpcNCULOnYbrgQD0f2yEHhNaaQbkKaaSuojs6PAg2q0EVYdMyrChSEki+KTlC/A/gRtoLc8foYZO5CR1acCB13+RMBJzQVf4Md3OmMQsAyVkOS0A00N6i8F9eL1uv6XSyi3m8DktmJxCTc9B9FkgwdHI6LeNSpob9o1CSo35qzvqOEwCVNOMtSrbxcAVXRg9Kl8ew+B/yncnxsdXwBpNFUxyRer0GEnUKTKlUxJjdLWbISxULVyZEKrqnBa4ngNap8dN46ltqOsuJCFkaHxxZMqapN2UG9tz9Kgk4G1pf3wbmbn16ZhrDAAk3KVUlzZstWUz4G9iy5wANhNcqtxvj1r/GpPgohnyuff/wI+Gg=
  - secure: gw2eO4QGte3iNVz5+usKXX0KJZkSuqQLsUHg07TwZM93GHoBjuNBgmo0y/+MEFNl2de3RoExMYfBuBqw9HCYmgHfm1b5s40/5O+a5JrXKiO2N/bInmzZrQC/AxP/kBHMANa4HlFWw4ZqpJAgwvuev8g4pB4RYh+vQEAT+3dHBniQmb5N/9xTsFK9uMlj4mD9jhssOv/vg7wP1OX+LCfu6D3DCHzlm7L1iAxkub6L2R4CpweYeDcj6l+0Wt8i0SwCgMW5rTOFl+EtiD6ga9p7H4AUhIH43ze13R+Hpx0RH52YENdBCPPn9Op4GcMA47OhpO2HGShOCndRxUgJ+e+8MwyqJVY91xxnkgQUfF5wXSJ+IFIOL+ZMuC4n5tdtbUAXaIGtvNJK29Wad6xw+P2fTQ4rZ2hJRorBdq2+Lu2mmwrSkpudqQ2r9Tcz6sBPTzFJNuRcWiim281i+K2tYsnPqaUxvX4tWHQ6k8byhbHuC2OC1sPM/WESzbEp1yeE1KgCE8bnX0WymAhzxYTfn9OKwPlFV8OkIJlr5r3lmUfBM0aOVSKdsk3FKpxVtN94hJ+tUHydzMjCmG3SU+EcD+VAurYKlhCSTJpJ3wr54g/UTfzEzK7IUDs6b8YJrRh+jmNdlm56T2bNq7CTPAjZ0n68M/FQ5hSdEDOPmdvGe54ZnMM=
  - secure: DXQznkL22YWOxxiajdolEkLnZrYLY9MjuJPwK98z7FmLhvu6z/Vi96KYmTL1d7f6IiPYgb46exbYNLDOUZ+njySEZ5oJAh/G9JVdrx9Qu/Fz0Y6nON/YQ2RFDG7LahmlUECbQwxz6vqu4P3BJIvHhe15Gh+k7vzUABg0snViGUew2FinjqO97Rw2e6CYfi2Ta8SEvE25VbRJO26P2wGTuZNauMGydDvu/buQ8wkiWg42WmrV1Z+r44AUbhAxdOGzSGKdF9avN8rK5pDlMkcTbKhVPXK7G6e01KmdFPhy49GogKx9N1tPooVJU09GIrBpFYjWg01nmR3a0hFLyXSAdg/U+5rzp5ltvCpusx16yu5paXOosah+s/hAsc3vp9XywbboNGmtZaMgrN771XT955YGW9hDs6kHuqEtE3WF6T+7YHGdN0dLMMqfDWj6EnPfdTvlPuhSiIdNnxw2Hoyd1TRVsY6m/dP5dReDAmxOg8+5kIMvgRIsohQEgjHE/MM6IXsm47soZJQXDgCmBm1c7gK08ZB5y4/DRroFbhmvkoYNYvK/IzlvH0w9/HRtU+byXUtmIhcfngNHe3UXIo0adlgqr3KB00reOA9ZAZ5RP2PR6Mg3NpXZzMbTIflMSLh+O1azm0drzBxIzLWTBlzBVPk7Hg577wJ5Vhtg0BZ06Vs=
  - secure: ka+vJ+gVf9wWFRXrsGw1dOYGF6xGi63gxjkQ/fLWonr0pDwpVVJEzKDUZ0Xeal07wbK5fnEptxusrKXNUyJpPVXzOHfR7YHbhGkKdaQ3sZ+wKfVSP+HV34hWDM6IGz/YOEewyj+zodJ13UGxENGkk1Bidp+bviYX+kQClSFoSzh+tf1JzalnP12TqlEFdocJZ3ilj4TvMkVaX7Sn65PtLjInaGMxyiyNIp9SSnSejDS1A8I5tIwwodztILvgfmy4K8eJY2UzTr6mnuhV+cKvVTH0jsnVhGRkH02gowBUlKIZ9Zn9B0U+OXcSmWS8VeIMGZ7sL+hOp1fOpQwTVDSIc9cnWsKO3kskinUEJnBez4zn0lY4OfQ7f/iZ3Lf8cyy4emPhxnNCkiuvBqagKFIS5q1saXEQIKuLIBc72iIYnKTHz66CqGoYZy0jRGuF8NR9Wa8Toz6+DtLWdb3sUUj6txZE38tJn05tnSu0LpZLgBmB3XNR1eRKdL0xCJqW1aV2VwpAw98gy4Req4y16NhUwVWSJw2LzsuSLEm8/08375mUmtheY2kj3YBXWFqJT5p4O7Fv7RRy/BAA+aeo4D7k/4zuViApud6Ny5uhBn6iqXaPBgIcIVP7LPAWA0MP9qyg1/NUQ6jNRk9kZ39Xa9ol9jRHMhzuJ1g9CSNw/BZGfuU=
  - secure: wm3fzdS/qmcRc4ylLatJI6Hh3BMTxxo51zbvKyim5b/ao5L9W6BiR80z0vkMyqGf5LFxUJk+2p2Fp+t0ENGFVDevboaYKdzlNGTKXXP7GCuyswVhMYAJ+8zQ3uGI9yN+7iDCUVR2yfu10go0KXqFn2aU2FO2P/zt9VxiCA8R/jvQF/ma3iUr14o1X5RdezbgszYVXzKKY4dWcKgxD88wr8tqJzwp79KGytuMHTtz5vWkw5bvTuAoxpZCXSkwI3FNWFX5ctcz0OZHfYMR5xM9/YMvG7OF9Vqd1ejYhwbuiBofSwskzAifpArQw++RX09bEjxR5l8/8TMvLvePy4EbglqdwpE3+A1qxPo3Vmda8hFYauMDbObx+wyFDtt5qsoXDTUds90IaWbAqhBjcPlNc1vObiQIUQUAa3JAc1DujkEFgboRIwKeBqQPcK0XyPt3ocl4Kq7AinXIY6gZEhTnsumKCTFpQikes0PaFp2wgnDeRYAyHNmAnweHiPqKnc/+vMU+R0XOpilPs87ynoeCcjpmAC50foKxCGI2E8ZqGnT/ScdToVORVOTFZanF3Y+trWt65ppeb6B6FN7SmQat0hcI3kkH4asm65QCZbfko4AmtTIXzh2EJshIbXsi8F1IaMLOLDyZ5rrefBWkR4OD0GuN1wHlAMXUlZfxH7CPIqE=
